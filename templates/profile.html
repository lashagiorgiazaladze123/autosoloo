{% extends 'base.html' %}
{% block title %}My Profile - AutoSlo{% endblock %}
{% block content %}

<!-- Profile Header -->
<div class="profile-header">
    <div class="profile-info">
        <div class="profile-avatar">
            <i class="fas fa-user-circle" aria-hidden="true"></i>
        </div>
        <div class="profile-details">
            <h1>{{ current_user.username }}</h1>
            <p class="profile-email">
                <i class="fas fa-envelope" aria-hidden="true"></i>
                {{ current_user.email if current_user.email else 'No email provided' }}
            </p>
            <p class="profile-since">
                <i class="fas fa-calendar" aria-hidden="true"></i>
                Member since 2024
            </p>
        </div>
    </div>
    <a href="/upload" class="btn-modern btn-primary">
        <i class="fas fa-plus-circle" aria-hidden="true"></i>
        Upload New Car
    </a>
</div>

<!-- Profile Stats -->
<div class="profile-stats">
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-car" aria-hidden="true"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ cars|length }}</div>
            <div class="stat-label">Active Listings</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-eye" aria-hidden="true"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ cars|length * 42 }}</div>
            <div class="stat-label">Total Views</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-heart" aria-hidden="true"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ cars|length * 8 }}</div>
            <div class="stat-label">Favorites</div>
        </div>
    </div>
</div>

<!-- Cars Section -->
<section class="profile-cars-section">
    <div class="section-header">
        <h2>
            <i class="fas fa-warehouse" aria-hidden="true"></i>
            My Car Listings
        </h2>
        <p class="section-subtitle">Manage your uploaded vehicles</p>
    </div>
    
    {% if cars %}
    <div class="car-list">
        {% for car in cars %}
        <article class="car-card" itemscope itemtype="https://schema.org/Car">
            <!-- Car Image -->
            {% if car.get_images() %}
            <img 
                src="{{ url_for('static', filename=car.get_images()[0]) }}" 
                alt="{{ car.make }} {{ car.model }}"
                class="car-card-image"
                loading="lazy"
                itemprop="image">
            {% else %}
            <div class="car-card-no-image">
                <i class="fas fa-car" aria-hidden="true"></i>
            </div>
            {% endif %}
            
            <!-- Car Info -->
            <div class="car-card-body">
                <h3 itemprop="name">{{ car.make }} {{ car.model }}</h3>
                <p class="car-card-year">
                    <i class="fas fa-calendar" aria-hidden="true"></i>
                    {{ car.year }}
                </p>
                <div class="car-card-price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                    <span itemprop="price">${{ "{:,.0f}".format(car.price) }}</span>
                    <meta itemprop="priceCurrency" content="USD">
                </div>
                
                <!-- Quick Stats -->
                <div class="car-card-stats">
                    {% if car.mileage %}
                    <span title="Mileage">
                        <i class="fas fa-road" aria-hidden="true"></i>
                        {{ "{:,.0f}".format(car.mileage) }} km
                    </span>
                    {% endif %}
                    {% if car.engine %}
                    <span title="Engine">
                        <i class="fas fa-cog" aria-hidden="true"></i>
                        {{ car.engine }}
                    </span>
                    {% endif %}
                </div>
            </div>
            
            <div class="card-actions">
                <a href="/car/{{ car.id }}" class="btn btn-small">
                    <i class="fas fa-eye" aria-hidden="true"></i>
                    View
                </a>
                <a href="/edit_car/{{ car.id }}" class="btn btn-small edit-btn">
                    <i class="fas fa-edit" aria-hidden="true"></i>
                    Edit
                </a>
                <form method="POST" action="/delete_car/{{ car.id }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this car listing?');">
                    <button type="submit" class="btn btn-small delete-btn">
                        Delete
                    </button>
                </form>
            </div>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">
            <i class="fas fa-car-side" aria-hidden="true"></i>
        </div>
        <h2>No Cars Uploaded Yet</h2>
        <p>Start selling by uploading your first car listing!</p>
        <a href="/upload" class="btn-modern btn-primary btn-large">
            <i class="fas fa-upload" aria-hidden="true"></i>
            Upload Your First Car
        </a>
    </div>
    {% endif %}
</section>

{% endblock %}